<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
  <section class="bg-white p-6 rounded-xl shadow-md">
    <h2 class="text-xl font-semibold mb-4">Add Task</h2>

    <%= turbo_frame_tag "new_task" do %>
      <%= form_with model: @task, local: true do |f| %>
        <div class="mb-4">
          <%= f.label :title, class: "block text-sm font-medium" %>
          <%= f.text_field :title, class: "mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm focus:ring-2 focus:ring-indigo-500" %>
        </div>

        <div class="mb-4">
          <%= f.label :description, class: "block text-sm font-medium" %>
          <%= f.text_area :description, rows: 4, class: "mt-1 block w-full rounded-md border border-gray-300 p-2 shadow-sm focus:ring-2 focus:ring-indigo-500" %>
        </div>

        <div class="flex gap-4 mb-4">
          <div class="flex-1">
            <%= f.label :due_date, class: "block text-sm font-medium" %>
            <%= f.date_field :due_date, class: "mt-1 block w-full rounded-md border border-gray-300 p-2" %>
          </div>

          <div class="w-36">
            <%= f.label :priority, class: "block text-sm font-medium" %>
            <%= f.select :priority, Task.priorities.keys.map { |k| [k.titleize, k] }, {}, class: "mt-1 block w-full rounded-md border border-gray-300 p-2" %>
          </div>
        </div>

        <div class="flex items-center gap-3">
          <%= f.submit "Add Task", class: "bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md transition" %>
          <%= link_to "Clear", root_path, class: "text-gray-500 hover:underline" %>
        </div>
      <% end %>
    <% end %>
  </section>

  <section class="lg:col-span-2">
    <h2 class="text-lg font-semibold mb-4">Your Tasks (<%= pluralize(Task.count, "task") %>)</h2>
    <div class="space-y-4">
      <% @tasks.each do |task| %>
        <div class="bg-white p-4 rounded-xl shadow hover:shadow-lg transition-shadow flex items-start gap-4">
          <%= button_to toggle_complete_task_path(task), method: :patch, class: "rounded-full p-2 border", form: { "data-turbo": "false" } do %>
            <% if task.completed %>
              <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M5 13l4 4L19 7"></path></svg>
            <% else %>
              <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><circle cx="12" cy="12" r="9"></circle></svg>
            <% end %>
          <% end %>

          <div class="flex-grow">
            <h3 class="font-semibold text-lg <%= 'line-through text-gray-400' if task.completed %>"><%= task.title %></h3>
            <p class="text-gray-600"><%= task.description %></p>

            <div class="flex justify-between text-sm mt-2">
              <span class="inline-block px-2 py-1 rounded-full text-xs font-medium
                <%= case task.priority
                    when "high" then "bg-red-100 text-red-700"
                    when "medium" then "bg-yellow-100 text-yellow-700"
                    else "bg-green-100 text-green-700"
                    end %>">
                <%= task.priority.titleize %>
              </span>

            </div>

            <div class="mt-3 flex gap-4 text-sm text-gray-500">
              <%= link_to "Edit", edit_task_path(task), class: "hover:underline" %>
              <%= link_to "Delete", task_path(task), method: :delete, data: { confirm: "Are you sure?" }, class: "hover:underline text-red-600" %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </section>
</div>
